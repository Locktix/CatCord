{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alanp\\\\Documents\\\\GitHub\\\\Catcord\\\\catcord-frontend\\\\src\\\\components\\\\MessageList.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { db, auth } from \"../firebase\";\nimport { collection, addDoc, query, where, orderBy, onSnapshot, serverTimestamp } from \"firebase/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MessageList({\n  channelId\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n  const user = auth.currentUser;\n  const bottomRef = useRef(null);\n  useEffect(() => {\n    if (!channelId) return;\n    const q = query(collection(db, \"messages\"), where(\"channelId\", \"==\", channelId), orderBy(\"createdAt\", \"asc\"));\n    const unsub = onSnapshot(q, snapshot => {\n      setMessages(snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      })));\n      setLoading(false);\n    });\n    return () => unsub();\n  }, [channelId]);\n  useEffect(() => {\n    var _bottomRef$current;\n    (_bottomRef$current = bottomRef.current) === null || _bottomRef$current === void 0 ? void 0 : _bottomRef$current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [messages]);\n  const handleSendMessage = async e => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n    await addDoc(collection(db, \"messages\"), {\n      content: newMessage,\n      channelId,\n      author: user.email,\n      authorId: user.uid,\n      createdAt: serverTimestamp()\n    });\n    setNewMessage(\"\");\n  };\n  if (!channelId) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full max-w-md mx-auto mt-6 flex flex-col h-[400px] bg-gray-900 bg-opacity-60 rounded-xl shadow-lg\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto p-4 space-y-2\",\n      children: [loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-purple-200\",\n        children: \"Chargement...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 11\n      }, this) : messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-purple-300\",\n        children: \"Aucun message pour l'instant.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 11\n      }, this) : messages.map(msg => {\n        var _msg$createdAt;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `p-2 rounded ${msg.authorId === user.uid ? 'bg-indigo-700 text-right ml-10' : 'bg-gray-800 text-left mr-10'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-purple-300\",\n            children: [msg.author, \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"opacity-60\",\n              children: (_msg$createdAt = msg.createdAt) !== null && _msg$createdAt !== void 0 && _msg$createdAt.toDate ? msg.createdAt.toDate().toLocaleTimeString() : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 55,\n              columnNumber: 69\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-base\",\n            children: msg.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 15\n          }, this)]\n        }, msg.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 13\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: bottomRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSendMessage,\n      className: \"flex gap-2 p-3 border-t border-gray-800 bg-gray-900 rounded-b-xl\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\xC9crire un message...\",\n        value: newMessage,\n        onChange: e => setNewMessage(e.target.value),\n        className: \"flex-1 px-3 py-2 rounded bg-gray-800 text-white border border-gray-700 focus:outline-none\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded text-white font-semibold\",\n        children: \"Envoyer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 5\n  }, this);\n}\n_s(MessageList, \"Q/alxueNLgFABlTExIHVLj/3HbM=\");\n_c = MessageList;\nvar _c;\n$RefreshReg$(_c, \"MessageList\");","map":{"version":3,"names":["React","useEffect","useState","useRef","db","auth","collection","addDoc","query","where","orderBy","onSnapshot","serverTimestamp","jsxDEV","_jsxDEV","MessageList","channelId","_s","messages","setMessages","newMessage","setNewMessage","loading","setLoading","user","currentUser","bottomRef","q","unsub","snapshot","docs","map","doc","id","data","_bottomRef$current","current","scrollIntoView","behavior","handleSendMessage","e","preventDefault","trim","content","author","email","authorId","uid","createdAt","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","msg","_msg$createdAt","toDate","toLocaleTimeString","ref","onSubmit","type","placeholder","value","onChange","target","required","_c","$RefreshReg$"],"sources":["C:/Users/alanp/Documents/GitHub/Catcord/catcord-frontend/src/components/MessageList.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { db, auth } from \"../firebase\";\r\nimport { collection, addDoc, query, where, orderBy, onSnapshot, serverTimestamp } from \"firebase/firestore\";\r\n\r\nexport default function MessageList({ channelId }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const user = auth.currentUser;\r\n  const bottomRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (!channelId) return;\r\n    const q = query(\r\n      collection(db, \"messages\"),\r\n      where(\"channelId\", \"==\", channelId),\r\n      orderBy(\"createdAt\", \"asc\")\r\n    );\r\n    const unsub = onSnapshot(q, (snapshot) => {\r\n      setMessages(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));\r\n      setLoading(false);\r\n    });\r\n    return () => unsub();\r\n  }, [channelId]);\r\n\r\n  useEffect(() => {\r\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  const handleSendMessage = async (e) => {\r\n    e.preventDefault();\r\n    if (!newMessage.trim()) return;\r\n    await addDoc(collection(db, \"messages\"), {\r\n      content: newMessage,\r\n      channelId,\r\n      author: user.email,\r\n      authorId: user.uid,\r\n      createdAt: serverTimestamp(),\r\n    });\r\n    setNewMessage(\"\");\r\n  };\r\n\r\n  if (!channelId) return null;\r\n\r\n  return (\r\n    <div className=\"w-full max-w-md mx-auto mt-6 flex flex-col h-[400px] bg-gray-900 bg-opacity-60 rounded-xl shadow-lg\">\r\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-2\">\r\n        {loading ? (\r\n          <div className=\"text-purple-200\">Chargement...</div>\r\n        ) : messages.length === 0 ? (\r\n          <div className=\"text-purple-300\">Aucun message pour l'instant.</div>\r\n        ) : (\r\n          messages.map(msg => (\r\n            <div key={msg.id} className={`p-2 rounded ${msg.authorId === user.uid ? 'bg-indigo-700 text-right ml-10' : 'bg-gray-800 text-left mr-10'}`}>\r\n              <div className=\"text-xs text-purple-300\">{msg.author} <span className=\"opacity-60\">{msg.createdAt?.toDate ? msg.createdAt.toDate().toLocaleTimeString() : ''}</span></div>\r\n              <div className=\"text-base\">{msg.content}</div>\r\n            </div>\r\n          ))\r\n        )}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n      <form onSubmit={handleSendMessage} className=\"flex gap-2 p-3 border-t border-gray-800 bg-gray-900 rounded-b-xl\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Ã‰crire un message...\"\r\n          value={newMessage}\r\n          onChange={e => setNewMessage(e.target.value)}\r\n          className=\"flex-1 px-3 py-2 rounded bg-gray-800 text-white border border-gray-700 focus:outline-none\"\r\n          required\r\n        />\r\n        <button type=\"submit\" className=\"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded text-white font-semibold\">Envoyer</button>\r\n      </form>\r\n    </div>\r\n  );\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}